@model escupe.ViewModels.CadastroEmpresaViewModel
@{
    var etapa = ViewBag.Etapa ?? 1;
    Layout = null;
}

@section Styles{
    <link rel="stylesheet" href="~/css/style.css" asp-append-version="true"/>
}

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="~/css/style.css" />
    <link rel="icon" href="~/imagens/favicon.png" type="image/png">
    <title>@ViewData["Title"]</title>
    <link href="https://api.fontshare.com/v2/css?f[]=satoshi@400,500,700,900&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,700;1,14..32,700&display=swap" rel="stylesheet" />
</head>

<header class="site-header">
    <a href="index.html" class="icone-container">
        <img src="imagens/icone.png" alt="Logo do Site" class="site-logo">
        <span class="site-nome">Esculp</span>
    </a>
</header>

<h1 id="h1-cadastro">Conecte sua empresa a novos talentos</h1>
<p id="p-cadastro">Cadastre sua empresa gratuitamente e encontre jovens profissionais prontos para crescer junto com você.</p>

@if (etapa == 1)
{
    <form asp-action="CadastrarEmpresa" method="post">
        <input asp-for="TipoUsuario" type="hidden" />
        <input type="hidden" name="etapa" value="1" />
        <div asp-validation-summary="ModelOnly" class="text-danger"></div>

        <div class="step active">
            <h2>Informações de Acesso</h2>
            <p>Preencha as informações abaixo:</p>
            
            <div class="inputs-container">
                <div>
                    <label for="email_empresa">E-mail corporativo:</label>
                    <input asp-for="Email" class="form-control" />
                </div>
                <div>
                    <label for="telefone_empresa">Telefone para contato:</label>
                    <input asp-for="Telefone" class="form-control" />
                </div>
                <div>
                    <label for="senha_empresa">Senha:</label>
                    <input asp-for="Senha" class="form-control" type="password" />
                </div>
                <div>
                    <label for="confirmar_senha_empresa">Confirme sua senha:</label>
                    <input asp-for="confSenha" class="form-control" type="password" />
                </div>
            </div>
            <button type="submit">Continuar</button>
        </div>
    </form>
}
else if (etapa == 2)
{
    <form asp-action="CadastrarEmpresa" method="post">
        <input asp-for="TipoUsuario" type="hidden" />
        <input type="hidden" name="etapa" value="2" />
        <input type="hidden" asp-for="Email" />
        <input type="hidden" asp-for="Telefone" />
        <input type="hidden" asp-for="Senha" />
        <div asp-validation-summary="ModelOnly" class="text-danger"></div>

        <div class="step active">
            <h2>Dados da Empresa</h2>
            <p>Preencha as informações abaixo:</p>

            <div class="inputs-container">
                <div>
                    <label for="nome_empresa">Nome da empresa:</label>
                    <input asp-for="NomeFantasia" class="form-control" />
                </div>
                <div>
                    <label for="area_atuacao">Razão social:</label>
                    <input asp-for="RazaoSocial" class="form-control" />
                </div>
                <div>
                    <label for="cnpj">CNPJ da empresa:</label>
                    <input asp-for="CNPJ" class="form-control" id="CNPJ" />
                </div>
                <div>
                    <label for="area_atuacao">Área de atuação:</label>
                    <select asp-for="AreaAtuacao" class="form-control" id="area_atuacao" required>
                        <option value="">Selecione</option>
                        <option value="administracao">Administração</option>
                        <option value="tecnologia">Tecnologia da Informação</option>
                        <option value="comercio">Comércio / Varejo</option>
                        <option value="educacao">Educação</option>
                        <option value="saude">Saúde</option>
                        <option value="industria">Indústria</option>
                        <option value="servicos">Serviços Gerais</option>
                        <option value="outros">Outros</option>
                    </select>
                </div>
                <div>
                    <label for="cep">CEP:</label>
                    <input asp-for="CEP" class="form-control" id="cep" maxlength="9" />
                </div>
                <div>
                    <label for="rua">Rua:</label>
                    <input asp-for="Logradouro" class="form-control" id="logradouro" readonly />
                </div>
                <div>
                    <label for="numero">Número:</label>
                    <input asp-for="Numero" class="form-control" id="numero" />
                </div>
                <div>
                    <label for="complemento">Complemento:</label>
                    <input asp-for="Complemento" class="form-control" id="complemento" />
                </div>
                <div>
                    <label for="bairro">Bairro:</label>
                    <input asp-for="Bairro" class="form-control" id="bairro" readonly />
                </div>
                <div>
                    <label for="cidade">Cidade:</label>
                    <input asp-for="Cidade" class="form-control" id="cidade" readonly />
                </div>
                <div>
                    <label for="estado">Estado:</label>
                    <input asp-for="UF" class="form-control" id="uf" readonly />
                </div>
            </div>
            <div>
                <button type="submit" class="btn btn-primary btn-centralizado">Finalizar Cadastro</button>
            </div>
        </div>
        
        
    </form>
}

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
<script>
    $(document).ready(function () {
        $('#Telefone').mask('(00) 00000-0000');
        // Máscara de e-mail geralmente não é aplicada, mas pode validar com regex no backend
    });
</script>
<script>
    $(document).ready(function () {
        $('#CNPJ').mask('00.000.000/0000-00');
        $('#cep').mask('00000-000');
    });

    $('#cep').on('blur', function () {
        var cep = $(this).val().replace(/\D/g, '');
        if (cep.length === 8) {
            $.getJSON('https://viacep.com.br/ws/' + cep + '/json/', function (data) {
                if (!data.erro) {
                    $('#logradouro').val(data.logradouro).prop('readonly', true);
                    $('#bairro').val(data.bairro).prop('readonly', true);
                    $('#cidade').val(data.localidade).prop('readonly', true);
                    $('#uf').val(data.uf).prop('readonly', true);
                } else {
                    alert('CEP não encontrado.');
                    $('#logradouro, #bairro, #cidade, #uf').val('').prop('readonly', false);
                }
            });
        } else {
            $('#logradouro, #bairro, #cidade, #uf').val('').prop('readonly', false);
        }
    });
</script>